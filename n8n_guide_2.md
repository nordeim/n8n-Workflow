# The Complete Guide to Creating Complex n8n Workflows in JSON Format

## Table of Contents
1. [Introduction to n8n and JSON Workflows](#introduction)
2. [Understanding the n8n Workflow JSON Structure](#json-structure)
3. [A Complex n8n Workflow Example](#complex-example)
4. [Detailed Breakdown of JSON Elements](#json-elements)
5. [Node Types and Customization](#node-types)
6. [Connections and Data Flow](#connections)
7. [Workflow Settings and Metadata](#settings)
8. [Working with Credentials](#credentials)
9. [Advanced Workflow Patterns](#advanced-patterns)
10. [Resources and References](#resources)
11. [Best Practices and Tips](#best-practices)
12. [Conclusion](#conclusion)

## 1. Introduction to n8n and JSON Workflows {#introduction}

n8n (pronounced "nodemation") is a powerful workflow automation tool that allows you to connect various services and create complex automation sequences. At its core, n8n workflows are defined in JSON format, making them portable, version-controllable, and programmable.

### What Makes n8n Special?

n8n stands out from other automation platforms due to its:
- **Fair-code license**: Source code is visible and self-hostable
- **Extensibility**: Create custom nodes and integrate any API
- **Visual workflow editor**: Design workflows visually while maintaining JSON structure underneath
- **Code flexibility**: Execute custom JavaScript/Python code within workflows

### The JSON Workflow Format

Every n8n workflow is ultimately stored as a JSON object containing:
- **Nodes**: Individual workflow steps (triggers, actions, logic)
- **Connections**: Links between nodes defining data flow
- **Settings**: Workflow-level configuration
- **Metadata**: Information about the workflow itself

Understanding this JSON structure is crucial for:
- Version control and collaboration
- Programmatic workflow generation
- Debugging and optimization
- Backup and migration

For comprehensive documentation on n8n's architecture, visit the [official n8n documentation](https://docs.n8n.io/).

## 2. Understanding the n8n Workflow JSON Structure {#json-structure}

Before diving into our complex example, let's understand the fundamental structure of an n8n workflow JSON:

```json
{
  "name": "Workflow Name",
  "nodes": [...],
  "connections": {...},
  "active": false,
  "settings": {...},
  "versionId": "...",
  "id": "...",
  "meta": {...},
  "tags": [...]
}
```

### Core Properties Explained:

**name**: The workflow's display name (string)
- Used for identification in the UI
- Should be descriptive and unique

**nodes**: Array of node objects
- Each node represents a workflow step
- Contains type, parameters, position, and credentials

**connections**: Object mapping node connections
- Defines how data flows between nodes
- Structure: `{nodeId: {outputType: [{node: targetNodeId, type: inputType}]}}`

**active**: Boolean indicating if workflow is active
- Only active workflows respond to triggers
- Can be toggled via API or UI

**settings**: Workflow-level configuration
- Execution timeout
- Error workflow references
- Save data settings

**versionId**: Internal version tracking
- Updated when workflow is modified
- Used for conflict resolution

**id**: Unique workflow identifier
- Generated by n8n
- Used in API calls and references

**meta**: Additional metadata
- Instance ID
- Workflow statistics

**tags**: Array of tag objects for organization
- Helps categorize and filter workflows

## 3. A Complex n8n Workflow Example {#complex-example}

Let's create a comprehensive e-commerce order processing workflow that demonstrates various n8n capabilities. This workflow will:

1. Receive order webhooks
2. Validate order data
3. Check inventory via API
4. Process payment
5. Update database
6. Send notifications
7. Handle errors gracefully

Here's the complete JSON workflow:

```json
{
  "name": "E-commerce Order Processing Pipeline",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "process-order",
        "responseMode": "responseNode",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "id": "2a7c4d89-3f5e-4b6c-8d9a-1e2f3a4b5c6d",
      "name": "Order Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [250, 300],
      "webhookId": "c8f7e9d2-4a6b-8c1d-2e3f-5a7b9d1e3f5a"
    },
    {
      "parameters": {
        "keepOnlySet": true,
        "values": {
          "string": [
            {
              "name": "orderId",
              "value": "={{$json[\"orderId\"]}}"
            },
            {
              "name": "customerEmail",
              "value": "={{$json[\"customer\"][\"email\"]}}"
            }
          ],
          "number": [
            {
              "name": "totalAmount",
              "value": "={{$json[\"totalAmount\"]}}"
            },
            {
              "name": "itemCount",
              "value": "={{$json[\"items\"].length}}"
            }
          ],
          "boolean": [
            {
              "name": "isValid",
              "value": "={{$json[\"orderId\"] && $json[\"customer\"][\"email\"] && $json[\"totalAmount\"] > 0}}"
            }
          ]
        },
        "options": {}
      },
      "id": "7b8c9d0e-1f2a-3b4c-5d6e-7f8a9b0c1d2e",
      "name": "Validate Order Data",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [450, 300]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json[\"isValid\"]}}",
              "value2": true
            }
          ]
        }
      },
      "id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f",
      "name": "Check Validation",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [650, 300]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.inventory.example.com/check",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "X-API-Key",
              "value": "={{$credentials.apiKey}}"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "items",
              "value": "={{$node[\"Order Webhook\"].json[\"items\"]}}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          },
          "retry": {
            "maxTries": 3,
            "waitBetweenTries": 1000
          }
        }
      },
      "id": "9d0e1f2a-3b4c-5d6e-7f8a-9b0c1d2e3f4a",
      "name": "Check Inventory",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [850, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "10",
          "name": "Inventory API"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const inventoryResponse = $input.item.json;\nconst orderData = $node[\"Validate Order Data\"].json;\n\n// Check if all items are in stock\nconst allInStock = inventoryResponse.items.every(item => item.inStock === true);\n\n// Calculate shipping cost\nconst shippingCost = orderData.totalAmount > 100 ? 0 : 10;\n\n// Prepare payment data\nconst paymentData = {\n  orderId: orderData.orderId,\n  amount: orderData.totalAmount + shippingCost,\n  currency: 'USD',\n  customerEmail: orderData.customerEmail,\n  items: inventoryResponse.items,\n  allInStock: allInStock,\n  shippingCost: shippingCost,\n  timestamp: new Date().toISOString()\n};\n\nreturn paymentData;"
      },
      "id": "5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b",
      "name": "Prepare Payment Data",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1050, 200]
    },
    {
      "parameters": {
        "operation": "charge",
        "amount": "={{$json[\"amount\"] * 100}}",
        "currency": "={{$json[\"currency\"]}}",
        "source": "tok_visa",
        "description": "Order {{$json[\"orderId\"]}}",
        "additionalFields": {
          "metadata": {
            "metadataProperties": [
              {
                "key": "orderId",
                "value": "={{$json[\"orderId\"]}}"
              },
              {
                "key": "customerEmail",
                "value": "={{$json[\"customerEmail\"]}}"
              }
            ]
          },
          "receiptEmail": "={{$json[\"customerEmail\"]}}"
        }
      },
      "id": "1f2a3b4c-5d6e-7f8a-9b0c-1d2e3f4a5b6c",
      "name": "Process Payment",
      "type": "n8n-nodes-base.stripe",
      "typeVersion": 1,
      "position": [1250, 200],
      "credentials": {
        "stripeApi": {
          "id": "11",
          "name": "Stripe Production"
        }
      }
    },
    {
      "parameters": {
        "operation": "insert",
        "schema": "public",
        "table": "orders",
        "columns": "orderId,customerEmail,totalAmount,paymentId,status,processedAt",
        "values": "={{$json[\"orderId\"]}},={{$json[\"customerEmail\"]}},={{$json[\"amount\"]}},={{$json[\"id\"]}},processed,={{$now.toISO()}}",
        "options": {
          "outputColumns": "*"
        }
      },
      "id": "7f8a9b0c-1d2e-3f4a-5b6c-7d8e9f0a1b2c",
      "name": "Update Database",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.3,
      "position": [1450, 200],
      "credentials": {
        "postgres": {
          "id": "12",
          "name": "Orders Database"
        }
      }
    },
    {
      "parameters": {
        "fromEmail": "orders@example.com",
        "toEmail": "={{$node[\"Prepare Payment Data\"].json[\"customerEmail\"]}}",
        "subject": "Order Confirmation - #{{$node[\"Prepare Payment Data\"].json[\"orderId\"]}}",
        "html": "<h2>Thank you for your order!</h2><p>Your order #{{$node[\"Prepare Payment Data\"].json[\"orderId\"]}} has been processed successfully.</p><p>Total: ${{$node[\"Prepare Payment Data\"].json[\"amount\"]}}</p><p>We'll send you tracking information once your order ships.</p>",
        "options": {
          "attachments": [],
          "ccEmail": "fulfillment@example.com"
        }
      },
      "id": "3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e",
      "name": "Send Confirmation Email",
      "type": "n8n-nodes-base.emailSend",
      "typeVersion": 2.1,
      "position": [1650, 200],
      "credentials": {
        "smtp": {
          "id": "13",
          "name": "Company SMTP"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "operation": "post",
        "channelId": "C1234567890",
        "text": "New order processed! 🎉\nOrder ID: {{$node[\"Prepare Payment Data\"].json[\"orderId\"]}}\nAmount: ${{$node[\"Prepare Payment Data\"].json[\"amount\"]}}\nCustomer: {{$node[\"Prepare Payment Data\"].json[\"customerEmail\"]}}",
        "options": {
          "username": "Order Bot",
          "icon_emoji": ":shopping_cart:"
        }
      },
      "id": "9b0c1d2e-3f4a-5b6c-7d8e-9f0a1b2c3d4e",
      "name": "Notify Slack",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.1,
      "position": [1850, 200],
      "credentials": {
        "slackOAuth2Api": {
          "id": "14",
          "name": "Slack Workspace"
        }
      }
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "success"
            },
            {
              "name": "message",
              "value": "Order processed successfully"
            },
            {
              "name": "orderId",
              "value": "={{$node[\"Prepare Payment Data\"].json[\"orderId\"]}}"
            }
          ]
        },
        "options": {}
      },
      "id": "5d6e7f8a-9b0c-1d2e-3f4a5b6c7d8e9f0a",
      "name": "Success Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [2050, 200]
    },
    {
      "parameters": {
        "options": {}
      },
      "id": "1d2e3f4a-5b6c-7d8e-9f0a1b2c3d4e5f6a",
      "name": "Respond to Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [2250, 300]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "status",
              "value": "error"
            },
            {
              "name": "message",
              "value": "Invalid order data"
            }
          ]
        },
        "options": {}
      },
      "id": "7d8e9f0a-1b2c-3d4e-5f6a7b8c9d0e1f2a",
      "name": "Error Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [850, 400]
    },
    {
      "parameters": {
        "errorMessage": "={{$node[\"Error Response\"].json[\"message\"]}}"
      },
      "id": "3d4e5f6a-7b8c-9d0e-1f2a3b4c5d6e7f8a",
      "name": "Stop and Error",
      "type": "n8n-nodes-base.stopAndError",
      "typeVersion": 1,
      "position": [1050, 400]
    }
  ],
  "connections": {
    "Order Webhook": {
      "main": [
        [
          {
            "node": "Validate Order Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validate Order Data": {
      "main": [
        [
          {
            "node": "Check Validation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Validation": {
      "main": [
        [
          {
            "node": "Check Inventory",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Error Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Inventory": {
      "main": [
        [
          {
            "node": "Prepare Payment Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Payment Data": {
      "main": [
        [
          {
            "node": "Process Payment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Process Payment": {
      "main": [
        [
          {
            "node": "Update Database",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update Database": {
      "main": [
        [
          {
            "node": "Send Confirmation Email",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send Confirmation Email": {
      "main": [
        [
          {
            "node": "Notify Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notify Slack": {
      "main": [
        [
          {
            "node": "Success Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Success Response": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Error Response": {
      "main": [
        [
          {
            "node": "Stop and Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "8f9a0b1c-2d3e-4f5a-6b7c8d9e0f1a2b3c"
  },
  "versionId": "4d5e6f7a-8b9c-0d1e-2f3a4b5c6d7e8f9a",
  "id": "2b3c4d5e-6f7a-8b9c0d1e2f3a4b5c6d7e8f9a",
  "meta": {
    "instanceId": "8f7e6d5c4b3a29180f7e6d5c4b3a2918"
  },
  "tags": [
    {
      "id": "15",
      "name": "e-commerce"
    },
    {
      "id": "16", 
      "name": "production"
    }
  ]
}
```

## 4. Detailed Breakdown of JSON Elements {#json-elements}

Now let's examine each JSON element in detail, understanding what each property does and how it can be customized.

### Node Structure

Each node in the `nodes` array has the following structure:

```json
{
  "parameters": {},
  "id": "unique-uuid",
  "name": "Node Display Name",
  "type": "node-type-identifier",
  "typeVersion": 1,
  "position": [x, y],
  "credentials": {},
  "disabled": false,
  "notes": "",
  "notesInFlow": false,
  "retryOnFail": false,
  "maxTries": 3,
  "waitBetweenTries": 1000,
  "alwaysOutputData": false,
  "executeOnce": false,
  "continueOnFail": false
}
```

#### Core Node Properties:

**parameters**: The main configuration object for the node
- Contains node-specific settings
- Structure varies by node type
- Can include expressions using n8n's expression syntax

**id**: Unique identifier for the node
- Must be globally unique within the workflow
- Usually a UUID format
- Referenced in connections

**name**: Human-readable node name
- Displayed in the UI
- Used in expressions to reference node data
- Should be descriptive and unique within workflow

**type**: Node type identifier
- Format: `n8n-nodes-base.nodeName` for built-in nodes
- Format: `@scope/n8n-nodes-custom` for community nodes
- Determines available parameters and behavior

**typeVersion**: Version of the node type
- Important for backward compatibility
- Newer versions may have different parameters
- Can be upgraded via the UI

**position**: Visual position in the editor
- Array of two numbers: [x, y]
- Used only for UI display
- Doesn't affect execution

**credentials**: References to stored credentials
- Object mapping credential type to credential ID/name
- Credentials are stored separately from workflows
- Multiple credential types possible per node

### Expression Syntax

n8n uses a powerful expression syntax for dynamic values:

```javascript
// Basic expressions
={{$json["field"]}}  // Access current node's data
={{$node["NodeName"].json["field"]}}  // Access another node's data
={{$items("NodeName")[0].json}}  // Access specific item from node

// Built-in variables
={{$execution.id}}  // Current execution ID
={{$workflow.id}}  // Workflow ID
={{$now}}  // Current timestamp
={{$today}}  // Today's date
={{$jmespath(json, "path.to.value")}}  // JMESPath query

// JavaScript expressions
={{new Date().toISOString()}}
={{Math.round($json["price"] * 1.1)}}
={{$json["items"].filter(item => item.active)}}
```

For detailed expression documentation, see the [n8n expression docs](https://docs.n8n.io/code-examples/expressions/).

### Connection Structure

The `connections` object defines how nodes are linked:

```json
"connections": {
  "Source Node Name": {
    "main": [
      [
        {
          "node": "Target Node Name",
          "type": "main",
          "index": 0
        }
      ]
    ]
  }
}
```

**Connection Properties**:
- **main**: Array of output branches (for nodes with multiple outputs)
- **node**: Name of the target node
- **type**: Connection type (usually "main")
- **index**: Input index on target node (usually 0)

### Workflow Settings

The `settings` object contains workflow-level configuration:

```json
"settings": {
  "executionOrder": "v1",
  "saveManualExecutions": true,
  "callerPolicy": "workflowsFromSameOwner",
  "executionTimeout": 3600,
  "errorWorkflow": "workflow-id",
  "saveDataSuccessExecution": "all",
  "saveDataErrorExecution": "all",
  "saveExecutionProgress": true,
  "timezone": "America/New_York"
}
```

**Key Settings**:
- **executionOrder**: Algorithm version for node execution order
- **saveManualExecutions**: Whether to save manual test runs
- **callerPolicy**: Who can trigger this workflow
- **executionTimeout**: Maximum execution time in seconds
- **errorWorkflow**: ID of workflow to run on error
- **timezone**: Timezone for date/time operations

## 5. Node Types and Customization {#node-types}

n8n offers various node types, each with specific parameters and customization options. Here are the main categories:

### Trigger Nodes

Trigger nodes start workflow execution:

**Webhook Trigger**:
```json
{
  "type": "n8n-nodes-base.webhook",
  "parameters": {
    "httpMethod": "POST",
    "path": "custom-endpoint",
    "responseMode": "onReceived",
    "responseData": "allEntries",
    "options": {
      "responseHeaders": {},
      "ignoreBots": true,
      "rawBody": false
    }
  }
}
```

**Schedule Trigger**:
```json
{
  "type": "n8n-nodes-base.scheduleTrigger",
  "parameters": {
    "rule": {
      "interval": [
        {
          "field": "hours",
          "hoursInterval": 1
        }
      ]
    }
  }
}
```

For more trigger options, check the [n8n trigger nodes documentation](https://docs.n8n.io/integrations/builtin/core-nodes/).

### Data Transformation Nodes

**Set Node** (for data manipulation):
```json
{
  "type": "n8n-nodes-base.set",
  "parameters": {
    "mode": "manual",
    "keepOnlySet": false,
    "values": {
      "string": [
        {
          "name": "newField",
          "value": "={{$json[\"oldField\"].toUpperCase()}}"
        }
      ],
      "number": [
        {
          "name": "calculation",
          "value": "={{$json[\"price\"] * $json[\"quantity\"]}}"
        }
      ]
    }
  }
}
```

**Code Node** (for custom JavaScript):
```json
{
  "type": "n8n-nodes-base.code",
  "parameters": {
    "mode": "runOnceForEachItem",
    "jsCode": "// Your JavaScript code here\nreturn {transformed: $input.item.json};"
  }
}
```

### Integration Nodes

**HTTP Request Node**:
```json
{
  "type": "n8n-nodes-base.httpRequest",
  "parameters": {
    "method": "POST",
    "url": "https://api.example.com/endpoint",
    "authentication": "genericCredentialType",
    "genericAuthType": "httpHeaderAuth",
    "sendHeaders": true,
    "headerParameters": {
      "parameters": [
        {
          "name": "Content-Type",
          "value": "application/json"
        }
      ]
    },
    "sendBody": true,
    "specifyBody": "json",
    "jsonBody": "={{JSON.stringify($json)}}",
    "options": {
      "timeout": 10000,
      "retry": {
        "maxTries": 3,
        "waitBetweenTries": 1000
      }
    }
  }
}
```

### Database Nodes

**PostgreSQL Node**:
```json
{
  "type": "n8n-nodes-base.postgres",
  "parameters": {
    "operation": "executeQuery",
    "query": "INSERT INTO users (email, name) VALUES ($1, $2) RETURNING *",
    "additionalFields": {
      "queryParams": "={{$json[\"email\"]}},={{$json[\"name\"]}}"
    },
    "options": {
      "queryBatching": true,
      "connectionTimeout": 30000
    }
  }
}
```

### Logic Nodes

**IF Node** (conditional branching):
```json
{
  "type": "n8n-nodes-base.if",
  "parameters": {
    "conditions": {
      "number": [
        {
          "value1": "={{$json[\"score\"]}}",
          "operation": "larger",
          "value2": 80
        }
      ],
      "string": [
        {
          "value1": "={{$json[\"status\"]}}",
          "operation": "equals",
          "value2": "active"
        }
      ]
    },
    "combineOperation": "all"
  }
}
```

**Switch Node** (multiple branches):
```json
{
  "type": "n8n-nodes-base.switch",
  "parameters": {
    "dataType": "string",
    "value1": "={{$json[\"category\"]}}",
    "rules": {
      "rules": [
        {
          "operation": "equals",
          "value2": "electronics",
          "output": 0
        },
        {
          "operation": "equals", 
          "value2": "clothing",
          "output": 1
        }
      ]
    },
    "fallbackOutput": 2
  }
}
```

## 6. Connections and Data Flow {#connections}

Understanding how data flows through connections is crucial for building complex workflows.

### Connection Types

**Main Connections**: Standard data flow
```json
"connections": {
  "Node A": {
    "main": [[{"node": "Node B", "type": "main", "index": 0}]]
  }
}
```

**Multiple Outputs**: For nodes like IF or Switch
```json
"connections": {
  "IF Node": {
    "main": [
      [{"node": "True Branch", "type": "main", "index": 0}],  // Output 0 (true)
      [{"node": "False Branch", "type": "main", "index": 0}]  // Output 1 (false)
    ]
  }
}
```

**Multiple Inputs**: Merging data streams
```json
"connections": {
  "Source 1": {
    "main": [[{"node": "Merge", "type": "main", "index": 0}]]
  },
  "Source 2": {
    "main": [[{"node": "Merge", "type": "main", "index": 1}]]
  }
}
```

### Data Access Patterns

```javascript
// Accessing data from previous node
={{$json}}  // Current item data
={{$items()}}  // All items from previous node
={{$item(0)}}  // First item
={{$items().length}}  // Number of items

// Accessing data from specific nodes
={{$node["Node Name"].json}}  // Latest item from specific node
={{$node["Node Name"].data}}  // All data from node
={{$items("Node Name")}}  // All items as array

// Working with binary data
={{$binary}}  // Binary data object
={{$binary.data}}  // Access specific binary property
```

## 7. Workflow Settings and Metadata {#settings}

### Execution Settings

```json
"settings": {
  "executionOrder": "v1",
  "executionTimeout": -1,
  "saveManualExecutions": true,
  "saveExecutionProgress": true,
  "saveDataSuccessExecution": "all",
  "saveDataErrorExecution": "all"
}
```

**Options explained**:
- **executionOrder**: Algorithm for determining node execution sequence
- **executionTimeout**: -1 for unlimited, or seconds for timeout
- **saveManualExecutions**: Store test run data
- **saveExecutionProgress**: Save intermediate states
- **saveDataSuccessExecution**: "all", "none", or "lastNode"
- **saveDataErrorExecution**: "all", "none", or "lastNode"

### Error Handling

```json
"settings": {
  "errorWorkflow": "workflow-id-here",
  "callerPolicy": "workflowsFromSameOwner"
}
```

Configure error workflows to handle failures gracefully. See the [error workflow documentation](https://docs.n8n.io/courses/level-two/chapter-2/) for details.

### Workflow Metadata

```json
"meta": {
  "instanceId": "unique-instance-id",
  "templateId": "template-id-if-from-template",
  "historyEvents": [
    {
      "action": "create",
      "timestamp": "2024-01-01T00:00:00.000Z",
      "user": "user@example.com"
    }
  ]
}
```

## 8. Working with Credentials {#credentials}

Credentials in n8n are referenced by ID and name, stored separately from workflows for security.

### Credential References

```json
"credentials": {
  "httpHeaderAuth": {
    "id": "10",
    "name": "API Key Auth"
  },
  "oauth2": {
    "id": "11",
    "name": "Google OAuth"
  }
}
```

### Creating Custom Credentials

For custom integrations, you can define credential types. See the [credentials documentation](https://docs.n8n.io/integrations/creating-nodes/build/reference/credentials/).

### Best Practices for Credentials

1. **Use descriptive names**: Make it clear what service/environment
2. **Separate environments**: Use different credentials for dev/prod
3. **Minimal permissions**: Grant only necessary access
4. **Regular rotation**: Update credentials periodically
5. **Audit usage**: Track which workflows use which credentials

## 9. Advanced Workflow Patterns {#advanced-patterns}

### Error Handling Pattern

```json
{
  "nodes": [
    {
      "type": "n8n-nodes-base.errorTrigger",
      "name": "Error Trigger",
      "parameters": {}
    },
    {
      "type": "n8n-nodes-base.code",
      "name": "Log Error",
      "parameters": {
        "jsCode": "const error = $input.item.json;\nconsole.error('Workflow error:', error);\nreturn error;"
      }
    }
  ]
}
```

### Retry Pattern with Exponential Backoff

```json
{
  "type": "n8n-nodes-base.httpRequest",
  "parameters": {
    "options": {
      "retry": {
        "maxTries": 5,
        "waitBetweenTries": 1000,
        "maxWaitTime": 60000,
        "backoffFactor": 2
      }
    }
  }
}
```

### Batch Processing Pattern

```json
{
  "type": "n8n-nodes-base.splitInBatches",
  "parameters": {
    "batchSize": 10,
    "options": {
      "reset": false
    }
  }
}
```

### Parallel Processing

Use multiple branches for parallel execution:
```json
"connections": {
  "Start": {
    "main": [
      [
        {"node": "Process A", "type": "main", "index": 0},
        {"node": "Process B", "type": "main", "index": 0},
        {"node": "Process C", "type": "main", "index": 0}
      ]
    ]
  }
}
```

## 10. Resources and References {#resources}

### Official Documentation
- **n8n Documentation**: [https://docs.n8n.io/](https://docs.n8n.io/)
- **API Reference**: [https://docs.n8n.io/api/](https://docs.n8n.io/api/)
- **Expression Reference**: [https://docs.n8n.io/code-examples/expressions/](https://docs.n8n.io/code-examples/expressions/)
- **Node Reference**: [https://docs.n8n.io/integrations/](https://docs.n8n.io/integrations/)

### Workflow Templates and Examples
- **Official Workflow Library**: [https://n8n.io/workflows](https://n8n.io/workflows)
- **Community Workflows**: [https://community.n8n.io/c/workflows/8](https://community.n8n.io/c/workflows/8)
- **GitHub Examples**: [https://github.com/n8n-io/n8n-workflow-examples](https://github.com/n8n-io/n8n-workflow-examples)

### YouTube Tutorials
- **n8n Official Channel**: [https://www.youtube.com/@n8n-io](https://www.youtube.com/@n8n-io)
- **"n8n Tutorial: Workflow Basics"**: Comprehensive introduction to workflow creation
- **"Advanced n8n: Custom Functions and Code"**: Deep dive into Code nodes
- **"n8n Masterclass Series"**: Multi-part series covering complex scenarios

### Community Resources
- **n8n Community Forum**: [https://community.n8n.io/](https://community.n8n.io/)
- **Discord Server**: Active community for real-time help
- **Reddit r/n8n**: [https://reddit.com/r/n8n](https://reddit.com/r/n8n)

### Blogs and Tutorials
- **n8n Blog**: [https://n8n.io/blog/](https://n8n.io/blog/)
- **"Building Production Workflows"**: Best practices guide
- **"n8n vs Zapier/Make"**: Comparison and migration guides
- **Dev.to n8n Tag**: Community tutorials and use cases

### Tools and Utilities
- **n8n-python-client**: Python library for n8n API
- **n8n-cli**: Command-line interface for workflow management
- **VS Code Extension**: Syntax highlighting for n8n expressions
- **Postman Collection**: API testing collection

## 11. Best Practices and Tips {#best-practices}

### Workflow Design Principles

1. **Modularity**: Break complex workflows into smaller, reusable sub-workflows
2. **Error Handling**: Always implement error catching and logging
3. **Documentation**: Use node notes to explain complex logic
4. **Naming Convention**: Use clear, consistent naming for nodes and workflows
5. **Version Control**: Store workflows in Git for collaboration

### Performance Optimization

1. **Batch Operations**: Process multiple items together when possible
2. **Selective Fields**: Use Set nodes to remove unnecessary data
3. **Caching**: Implement caching for frequently accessed data
4. **Async Processing**: Use webhook responses for long-running tasks
5. **Resource Limits**: Set appropriate timeouts and memory limits

### Security Best Practices

1. **Credential Isolation**: Never hardcode sensitive data
2. **Input Validation**: Always validate webhook and user inputs
3. **Access Control**: Implement proper authentication checks
4. **Audit Logging**: Log all critical operations
5. **Data Encryption**: Use HTTPS and encrypt sensitive data

### Testing Strategies

1. **Test Data**: Create comprehensive test datasets
2. **Unit Testing**: Test individual nodes with various inputs
3. **Integration Testing**: Test complete workflow paths
4. **Error Scenarios**: Test failure cases and recovery
5. **Load Testing**: Verify performance under load

### Debugging Techniques

1. **Execution Data**: Use "Save Manual Executions" during development
2. **Console Logging**: Add Code nodes for debugging output
3. **Step Execution**: Run workflows step by step
4. **Expression Testing**: Test expressions in the expression editor
5. **Error Workflows**: Implement detailed error logging workflows

## 12. Conclusion {#conclusion}

This comprehensive guide has covered the essential aspects of creating complex n8n workflows in JSON format. We've explored:

- The fundamental structure of n8n workflow JSON
- Detailed breakdown of all JSON elements and their properties
- A complex real-world example demonstrating various node types
- Expression syntax and data access patterns
- Advanced workflow patterns and best practices
- Extensive resources for continued learning

### Key Takeaways

1. **JSON Structure**: Understanding the JSON format enables version control, programmatic generation, and advanced customization
2. **Node Flexibility**: Each node type offers extensive parameters for customization
3. **Expression Power**: n8n's expression system allows complex data transformations
4. **Error Handling**: Proper error handling is crucial for production workflows
5. **Community Resources**: The n8n community provides extensive templates and support

### Next Steps

1. **Practice**: Import the example workflow and modify it for your use case
2. **Explore**: Browse the workflow library for inspiration
3. **Experiment**: Try different node combinations and expressions
4. **Share**: Contribute your workflows to the community
5. **Learn**: Follow n8n's blog and YouTube channel for updates

### Further Learning Resources

- **n8n Academy**: Official courses and certifications
- **API Documentation**: For programmatic workflow management
- **Node Development**: Create custom nodes for specific needs
- **Self-Hosting Guide**: Deploy n8n in your infrastructure
- **Enterprise Features**: Advanced features for organizations

Remember that mastering n8n workflows is an iterative process. Start with simple automations and gradually increase complexity as you become more comfortable with the platform. The JSON format provides ultimate flexibility, allowing you to create sophisticated automation solutions limited only by your imagination.

Whether you're automating business processes, integrating systems, or building complex data pipelines, understanding n8n's JSON workflow format empowers you to create robust, maintainable, and scalable automation solutions. Keep experimenting, learning from the community, and pushing the boundaries of what's possible with n8n.

For the latest updates and features, always refer to the official [n8n documentation](https://docs.n8n.io/) and join the vibrant [n8n community](https://community.n8n.io/) to connect with other automation enthusiasts and experts.
